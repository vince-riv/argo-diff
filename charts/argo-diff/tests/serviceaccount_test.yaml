---
suite: serviceaccount tests
template:
  - serviceaccount.yaml
tests:
  - it: default serviceaccount
    template: serviceaccount.yaml
    asserts:
      - containsDocument:
          apiVersion: v1
          kind: ServiceAccount
          name: RELEASE-NAME-argo-diff
      - equal:
          path: automountServiceAccountToken
          value: true
  - it: serviceaccount with options
    release:
      name: argo-diff
    set:
      serviceAccount.annotations:
        is_unittest: "yes"
    template: serviceaccount.yaml
    asserts:
      - containsDocument:
          apiVersion: v1
          kind: ServiceAccount
          name: argo-diff
      - equal:
          path: metadata.annotations.is_unittest
          value: "yes"
